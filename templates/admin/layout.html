<div class="wrapper">
  <aside class="sidebar">
    <h2>Admin</h2>
    <a href="/admin/users" class="nav-link">Пользователи</a>
    <a href="/admin/keys" class="nav-link">Генерация ключей</a>
    <a href="/admin/stats" class="nav-link">Статистика</a>
    <a href="/admin/notify" class="nav-link">Уведомления</a>
    <a href="/admin/monitor" class="nav-link">Мониторинг</a>
  </aside>

  <main class="content" id="admin-content">
    <!-- контент загружается сюда -->
  </main>
</div>

<script>
const adminContent = document.getElementById("admin-content");

async function loadPage(url, pushState=true) {
    try {
        const res = await fetch(url, { headers: { "X-Requested-With": "XMLHttpRequest" } });
        if (!res.ok) throw new Error("Ошибка загрузки");
        const html = await res.text();
        adminContent.innerHTML = html;

        // Вызов JS для страницы
        window.initPage?.();

        if (pushState) history.pushState(null, "", url);
    } catch(e) {
        console.error(e);
        adminContent.innerHTML = "<p>Ошибка загрузки страницы</p>";
    }
}

// Навигация через sidebar
document.querySelectorAll(".nav-link").forEach(link => {
    link.addEventListener("click", e => {
        e.preventDefault();
        loadPage(link.href);
    });
});

// Back/forward
window.addEventListener("popstate", () => loadPage(location.pathname, false));
</script>